{% assign current_lang = page.lang | default: "en" %}
{% assign service_key = include.service_id %}
{% if service_key and service_key[current_lang] %}
  {% assign service_key = service_key[current_lang] %}
{% endif %}
{% assign service = site.data.services[service_key] %}
{% if service %}
  {% assign hero = service.hero[current_lang] | default: service.hero.en %}
  {% assign hero_title = hero.title | default: service.title[current_lang] %}
  {% assign hero_intro = hero.intro %}
  {% assign hero_cta_data = hero.cta %}
  {% assign hero_cta_text = hero_cta_data.text | default: "Let's discuss your project" %}
  {% assign hero_cta_url = hero_cta_data.url %}
  {% unless hero_cta_url %}
    {% assign hero_cta_url = "/" | append: current_lang | append: "/contact.html" %}
  {% endunless %}
  {% assign first_section_subtitle = service.subtitles.first_section[current_lang] %}
  {% assign first_section_description = service.description[current_lang] %}
  {% assign second_section_subtitle = service.subtitles.second_section[current_lang] %}
  {% assign gallery_cta_url = "/" | append: current_lang | append: "/portfolio.html" %}
  {% if current_lang == "fr" %}
    {% assign services_title = "Ce que je propose" %}
    {% assign gallery_title = "Projets récents" %}
    {% assign gallery_cta_label = "Voir tous les projets" %}
    {% assign gallery_cta_url = "/fr/portfolio.html" %}
    {% assign tools_title = "Outils et expertises" %}
    {% assign highlight_fallback_title = "Pourquoi choisir Ropat ?" %}
    {% assign process_fallback_title = "Collaborer ensemble" %}
    {% assign final_cta_title = "Prêt à lancer votre projet ?" %}
    {% assign final_cta_description = "Que vous soyez un artiste, un collectif ou une marque, je suis là pour créer un univers visuel qui vous représente." %}
    {% assign final_cta_button_text = "Discutons de votre projet" %}
    {% assign final_cta_button_url = "/fr/contact.html" %}
  {% else %}
    {% assign services_title = "What I propose" %}
    {% assign gallery_title = "Recent projects" %}
    {% assign gallery_cta_label = "Browse all projects" %}
    {% assign gallery_cta_url = "/en/portfolio.html" %}
    {% assign tools_title = "Tools & expertise" %}
    {% assign highlight_fallback_title = "Why partner with Ropat?" %}
    {% assign process_fallback_title = "How we collaborate" %}
    {% assign final_cta_title = "Ready to launch your project?" %}
    {% assign final_cta_description = "Whether you're an artist, a collective or a brand, let's craft a visual universe that feels like you." %}
    {% assign final_cta_button_text = "Start a conversation" %}
    {% assign final_cta_button_url = "/en/contact.html" %}
  {% endif %}
  <main id="main-content" class="main-content service-detail">
    <section class="hero">
      <!-- Icône du service -->
      {% if service.icon %}
        <div class="service-icon-placeholder big-icon" aria-label="{{ service.icon_aria[current_lang] }}">
          {{ service.icon }}
        </div>
      {% endif %}
      <!-- Label du service -->
      <h1 class="hero-title">{{ hero_title | default:""}}</h1>
      <!-- Texte d'accroche-->
      {% if hero_intro %}
        <p class="hero-intro">{{ hero_intro }}</p>
      {% endif %}
      <!-- CTA -->
      <a class="cta" href="{{ hero_cta_url }}">{{ hero_cta_text }}</a>
    </section>
    <!-- SECTION TEST -->
    <section class="service-main-description">
      <h2 class="service-main-title">Plus qu’un logo : une stratégie complète</h2>
      <div class="service-main-text-placeholder">
        <p class="service-main-intro">Dans un marché saturé, <strong>la différenciation est la clé</strong>. Le branding n’est pas qu’une question d'apparence; c'est avant tout la promesse faite à vos clients. C'est pourquoi <strong>mon travail commence par définir votre positionnement</strong>, vos valeurs fondamentales, et votre ton de voix avant même de toucher à l'aspect graphique.</p>
        <p class="service-main-intro"><strong>L'objectif :</strong> vous équiper d’outils visuels et stratégiques pour communiquer avec assurance et de construire une relation durable avec votre audience.</p>
      </div>
    </section>
    <!-- FIN DE LA SECTION TEST-->
    <!-- 1ère sections - Services Card -->
    <section class="services-cards-section">
      <h3 class="section-title">{{ first_section_subtitle | default: services_title }}</h3>
      <div class="section-grid section-grid-simple">
        {% for service_item in service.services %}
          <div class="service-card service-card-simple">
            <div class="service-text-content">
              <h4 class="service-title">{{ service_item.nom[current_lang] }}</h4>
              {% if service_item.description %}
                <p class="service-card-description">{{ service_item.description[current_lang] }}</p>
              {% endif %}
            </div>
            {% if service_item.tools %}
              <div class="service-tools">
                {% for tool in service_item.tools %}
                  <span class="service-tool">{{ tool.nom }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </section>
    <section>
      <h3 class="section-title">{{ second_section_subtitle | default: gallery_title }}</h3>
      <!-- Projects Grid -->
      <div class="section-grid" id="projects-grid">
        <!-- Include Projects with "Music" category -->
        {% assign project_slugs = site.data.projects.index.order %}
        {% assign featured_index = 0 %}
        {% assign featured_rendered = 0 %}
        {% for slug in project_slugs %}
          {% assign item = site.data.projects[slug] %}
          {% if item.category and item.category contains service.tag %}
            {% include project-card.html project=item index=featured_index disable_animation=true %}
            {% assign featured_index = featured_index | plus: 1 %}
            {% assign featured_rendered = featured_rendered | plus: 1 %}
            {% if featured_rendered == 4 %}
              {% break %}
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
      <div class="cta-container">
        <a href="{{ gallery_cta_url }}" class="cta">
          {{ gallery_cta_label }}
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </a>
      </div>
  </section>
</main>
{% endif %}
